{% extends "base.html" %}
{% load i18n %}

{% block container %}
<div class="level">
    <div class="level-left">
      <h1 class="subtitle is-3">Hello .. {{request.user.username}}</h1>
    </div>
    <div class="level-rigth">

        <form action="{% url 'dashboard'%}" method="get">
          <div class="field is-grouped">
            <div class="control">
              <div class="select">
              
                 <select name="search_time">
                    <option value="m">This Month</option>
                    <option value="t">Today</option>
                    <option value="y">Yesterday</option>
                    <option value="w">This Week</option> 
                </select>

              </div>
            
            </div>
            <div class="control">
                  <button class="button" type="submit"> {% trans "Change" %}</button>
            </div>
          </div>
        </form>
    </div>
</div>

<div class="columns is-multiline">
            <div class="column is-12-tablet is-6-desktop is-3-widescreen">
              <div class="notification is-link has-text">
                <p class="title is-1">{{raw_services.count}}</p>
                <p class="subtitle is-4">Services</p>
              </div>
            </div>


            <div class="column is-12-tablet is-6-desktop is-3-widescreen">
              <div class="notification is-info has-text">
                <p class="title is-1">{{clients.count}}</p>
                <p class="subtitle is-4">Clients</p>
              </div>
            </div>


         <div class="column is-12-tablet is-6-desktop is-6-widescreen">
              <div class="notification is-warning has-text">
                <p class="title is-1">$ {{profit}}</p>
                <p class="subtitle is-4"> {% trans "Incomes" %} {% now "M Y" %}</p>
              </div>
            </div>
</div>

<div class="columns">
    <div class="column ">
        <h3 class="subtitle is-2">
      {% trans "Services" %}
        </h3>

        <div class="card">
           <div class="card-content">
              <div class="level">
                <div class="level-right ">
                  <h2 class="title is-4 tag is-danger is-light">
                    {% trans "Paid" %}
                  </h2>
                </div>
                <div class="level-left">
                  <h2 class="subtitle is-4  ">
                    $ {{raw_services.paid.sum}}
                    ({{raw_services.paid.count}})
                  </h2>
                </div>
              </div>
            </div>
        </div>

        <div class="card">
            <div class="card-content">
              <div class="level">
                <div class="level-right ">
                  <h2 class="title is-4 tag is-success is-light">
                   {% trans "Completed" %}
                  </h2>
                </div>
                <div class="level-left">
                  <h2 class="subtitle is-4 ">
                    $ {{raw_services.completed.sum}}
                  ({{raw_services.completed.count}})
                  </h2>
                </div>
              </div>
            </div>
        </div>

        <div class="card">
            <div class="card-content">
              <div class="level">
                <div class="level-right ">
                  <h2 class="title is-4 tag is-info is-light">
                    {% trans "Open" %}
                  </h2>
                </div>
                <div class="level-left">
                  <div class="level-item">
                    <h2 class="subtitle is-4">
                      $ {{raw_services.open.suma}}
                      ( {{raw_services.open.count}} ) 
                    </h2>
                  </div>
                
                </div>
              </div>


            </div>
        </div>

    </div>

    <div class="column  is-5">
                 <p class="subtitle is-2">
                    {% trans "Last Services" %}
                </p>
    
            {% for s in services %}
    <div class="card mb-s">
            <div class="card-content">
                  <div class="level mb-0">
                    <div class="level-left">
                            <h1 class="title is-4">
                              {{s.car.client}}
                            </h1>
                    </div>
                    <div class="level-right">
                        <div class="tag is-large is-{{s.get_color}} is-light">
                            {{s.get_status}}
                        </div>
                    </div>
                  </div>

                  <div class="card-content is-paddingless mt-xxs pb-s">
                        <p class="title is-3 m-0">
                          ${{s.total}}
                        </p>
                        <h2 class="subtitle mt-xxs">
                              {{s.car}}
                            </h2>
                             <small> 
                              {% trans "Reception was" %} {{s.reception_datetime|timesince}} {% trans "ago" %}
                             </small>
                  </div>
                        
      
  
            </div>             
            <footer class="card-footer has-background-light">
                    <a class="card-footer-item" href="{% url 'service_detail' s.id %}">
                      {% trans "View service" %}
                    </a>
            </footer>
        </div>        
         
            
            {% endfor %}


    
    </div>
</div>


{% endblock %}